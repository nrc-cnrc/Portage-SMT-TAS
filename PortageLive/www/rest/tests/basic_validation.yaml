# https://learnxinyminutes.com/docs/yaml/

name: "Exercice validating the parameters."

testSteps:
  - name: "No query"
    apiUrl: "{http}"
    method: "get"
    asserts:
      headers:
        status: 404
        Content-Type: "application/json"
      payload:
         Error: "Object"
         Error.message: "String"
         Error.message: "There is no query."


  - name: "No target"
    apiUrl: "{http}"
    method: "get"
    params:
      key: "unittest.rev-"
      prettyprint: false
      q: "home"
    asserts:
      headers:
        status: 404
        Content-Type: "application/json"
      payload:
         Error: "Object"
         Error.message: "String"
         Error.message: "You need to provide a target using target=X."


  - name: "Empty target"
    apiUrl: "{http}"
    method: "get"
    params:
      key: "unittest.rev-"
      target: ""
      prettyprint: false
      q: "home"
    asserts:
      headers:
        status: 404
        Content-Type: "application/json"
      payload:
         Error: "Object"
         Error.message: "String"
         Error.message: "You need to provide a target using target=X."


  - name: "There should be a query."
    apiUrl: "{http}"
    method: "get"
    params:
      key: "unittest.rev-"
      target: "fr"
      prettyprint: false
    asserts:
      headers:
        status: 404
        Content-Type: "application/json"
      payload:
         Error: "Object"
         Error.message: "String"
         Error.message: "You need to provide a query using q=X."


  - name: "Generating a SOAPFault with an invalid context/key."
    apiUrl: "{http}"
    method: "get"
    params:
      key: "invalid_context"
      target: "fr"
      prettyprint: false
      q: "home"
    asserts:
      headers:
        status: 404
        Content-Type: "application/json"
      payload:
         Error: "Object"
         Error.type: "String"
         Error.type: "PortageContext"
         Error.message: "String"
         Error.message: 'exec value.strip() == "Context \"invalid_contexten-fr\" does not exist."'


  - name: "Translate not pretty printed"
    apiUrl: "{http}"
    method: "get"
    raw: true
    params:
      key: "unittest.rev-"
      target: "fr"
      prettyprint: false
      q: "home"
    asserts:
      headers:
        status: 200
        Content-Type: "application/json"
      payload:
        __raw__: '{"data":{"translations":[{"translatedText":"emoh"}]}}'


  - name: "Translate pretty printed"
    apiUrl: "{http}"
    method: "get"
    raw: true
    params:
      key: "unittest.rev-"
      target: "fr"
      prettyprint: true
      q: "home"
    asserts:
      headers:
        status: 200
        Content-Type: "application/json"
      payload:
        __raw__: |
         {
             "data": {
                 "translations": [
                     {
                         "translatedText": "emoh"
                     }
                 ]
             }
         }

